# Number Search Tinker Training Configuration

# Training configuration
train:
  model_name: Qwen/Qwen3-4B-Instruct-2507
  renderer_name: qwen3_instruct
  batch_size: 32
  num_epochs: 5
  num_minibatches: 1
  num_microbatches: 1
  max_staleness: 3
  lora_rank: 32
  loss_fn: cispo
  loss_fn_config:
    clip_low_threshold: 0.0
    clip_high_threshold: 5.0
  optimizer:
    learning_rate: 3e-5
    beta1: 0.9
    beta2: 0.95
    eps: 1e-8
  workflow_config:
    group_size: 8
    rollout_config:
      max_steps: 10
      output_dir: ./rollout_results
      verbose: true
      timeout: 300
  num_concurrent_rollout_workflow_workers: 32

# Eval configuration
eval:
  strategy: step
  every: 10
  num_concurrent_rollout_workflow_workers: 50
  workflow_config:
    group_size: 1
    rollout_config:
      max_steps: 10
      output_dir: ./eval_results
      verbose: false
      timeout: 300

# Checkpoint configuration
checkpoint:
  strategy: epoch
  every: 5
  load_checkpoint_path: null

# Logging
log_path: ./logs
tinker_base_url: http://ec2-18-219-33-38.us-east-2.compute.amazonaws.com:8000

# Stats and WandB configuration
stats:
  experiment_name: number-search-platoon-tinker
  trial_name: skyrl-tx-grpo-trial0
  wandb:
    mode: online
    project: number-search-platoon-tinker
    entity: null
    tags:
      - number-search
      - tinker
      - grpo

